version: "3.4"
services:
  web-boot-dashboard-beta:
    image: ${registry:-docker.io}/ydcode/pack:web-boot-dashboard-beta-1.0.0
    container_name: web-boot-dashboard-beta
    env_file:
      - /root/env/web-boot-dashboard-beta.env
    volumes:
      - /var/run/docker.sock:/var/run/docker.sock
      - /usr/bin/docker:/usr/bin/docker
      - wwwroot_data:/home/wwwroot
      - ssl_data:/etc/letsencrypt
      - nginx_conf_data:/etc/nginx/conf.d
      - library_data:/home/library
    restart: always
    external_links:
      - nginx
      - useragent
      - rabbitmq
      - pika
    ports:
      - 1080:1080
    networks:
      - web_network
    logging:
      options:
        max-size: "200m"

  web-mail-submit:
    image: ${registry:-docker.io}/ydcode/pack:web-mail-submit-1.0.0
    container_name: web-mail-submit
    env_file:
      - /root/env/web-mail-submit.env
      - /root/env/mysql.env
    environment:
      - MAIL_SUBMIT_DOMAIN=${MAIL_SUBMIT_DOMAIN}
#      - DASHBOARD_USERNAME=${DASHBOARD_USERNAME}
#      - DASHBOARD_PASSWORD=${DASHBOARD_PASSWORD}


    volumes:
      - /var/run/docker.sock:/var/run/docker.sock
      - /usr/bin/docker:/usr/bin/docker
      - wwwroot_data:/home/wwwroot
      - ssl_data:/etc/letsencrypt
      - nginx_conf_data:/etc/nginx/conf.d
      - library_data:/home/library
    restart: always
    external_links:
      - nginx
      - useragent
      - rabbitmq
      - pika
    ports:
      - 3080:3080
    networks:
      - web_network
    logging:
      options:
        max-size: "200m"


networks:
  web_network:
    external:
      name: boot-base_base_network

volumes:
  mysql_data:
    name: mysql_data
  pika_data:
    name: pika_data
  nginx_conf_data:
    name: nginx_conf_data
  wwwroot_data:
    name: wwwroot_data
  wwwlogs_data:
    name: wwwlogs_data
  ssl_data:
    name: ssl_data
  library_data:
    name: library_data
